# 仕様決定完了サマリー

**作成**: 2026-02-02  
**ステータス**: 完了

---

## 完了した作業

### 1. 未確定事項の抽出と整理
- TODO.md / docs/ から全5項目を抽出
- 各項目の影響範囲を明確化
- 実装関連ファイルをマッピング

**成果物**: `docs/plans/2026-02-02-spec-decisions.md`

### 2. 複数オプション提示と評価
各項目ごとに 2～3 つのオプションを提示：

| 項目 | オプション数 | 推奨 |
|------|-----------|------|
| 1. 日付フィルタ仕様 | 3 | A（JST固定・含む・ISO8601のみ） |
| 2. ライブラリホワイトリスト | 3 | A（最小構成） |
| 3. S3認証方式 | 3 | A（IAMロール） |
| 4. JS ライブラリ管理 | 3 | A（社内CDN・固定版） |
| 5. 相対日付フィルタ | 3 | A（MVP外す） |

各オプションの推奨度（⭐5段階）と理由を詳細記載。

### 3. ドキュメント更新
- `docs/requirements.md` §6: 決定事項を反映
- `docs/design.md` §11: 決定事項を反映（新セクション追加）

---

## 確定された決定セット（2026-02-02）

### 日付フィルタ
- **タイムゾーン**: 処理なし（Dataset基準）- Dataset内の日付データをそのまま使用
- **範囲**: 開始・終了日ともに含む（直感的）
- **形式**: ISO 8601（YYYY-MM-DD）のみ
- **相対日付**: MVP では未実装 → V1+

### ライブラリ
- **MVP**: pandas, pyarrow, plotly, numpy, scipy, matplotlib, python-dateutil（標準構成）
- **イメージサイズ**: 約 1.0 GB
- **V1+**: scikit-learn, xgboost 等を検討予定

### S3 認証
- **方式**: IAM ロール（ECS タスク）経由
- **設計**: 全 API で共有 IAM ロール使用
- **マルチテナント**: 将来対応予定

### JS ライブラリ
- **管理**: 社内 CDN・バージョン固定
- **配置**: S3/CloudFront
- **更新**: バージョンごと新パス → CSP 更新

### 変更点（推奨案から）
1. **日付フィルタ**: JST固定 → Dataset基準（タイムゾーン処理なし）に変更
2. **ライブラリ**: 最小構成 → 標準構成に変更（numpy/scipy/matplotlib 追加）

---

## 次のアクション

### 短期（今週）
1. **確認**: チームリードが推奨決定セットを承認
2. **調整**: 異なる選択肢がある場合は理由を記載し返送
3. **確定**: 最終決定を `docs/plans/2026-02-02-spec-decisions.md` に反映

### 中期（来週以降）
4. **実装計画作成**: 決定事項に基づき詳細な実装タスク化
5. **コード実装**: 決定事項を反映した実装を開始
6. **テスト設計**: 決定事項ごとのテストケース設計

---

## 参照資料

| ファイル | 目的 |
|---------|------|
| `docs/plans/2026-02-02-spec-decisions.md` | 詳細な未確定事項分析・オプション比較 |
| `docs/requirements.md` | 更新済み仕様定義 |
| `docs/design.md` | 更新済み設計資料 |
| `TODO.md` | 現在の実装状況 |

---

## 補足

### なぜ決定が重要か
これらの5項目は以下の理由で実装を進める前に確定する必要があります：
- **バックエンド実装に影響**: フィルタロジック、認証、ライブラリ管理
- **フロントエンド UI に影響**: 日付入力フォーム、フィルタプリセット表示
- **セキュリティ方針に影響**: S3 アクセス、JS ライブラリ許可範囲
- **後戻りコスト**: 決定後の変更 = テスト再実装、ドキュメント修正

### 推奨セットの特徴
**MVP 重視の選択肢**:
- シンプルさ優先（複雑な処理を避ける）
- セキュリティ・保守性重視
- V1+ への拡張性確保（後から高度な機能追加可能）

**結果として**:
- MVP デリバリー加速
- バグ・セキュリティリスク削減
- チーム学習コスト削減

